<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Martin Lysy, Feiyu Zhu" />

<meta name="date" content="2021-01-06" />

<title>realPSD: Getting Started</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore"><strong>realPSD</strong>: Getting Started</h1>
<h4 class="author">Martin Lysy, Feiyu Zhu</h4>
<h4 class="date">2021-01-06</h4>


<div id="TOC">
<ul>
<li><a href="#model-setup">Model Setup</a>
<ul>
<li><a href="#ornstein-uhlenbeck-process">Ornstein-Uhlenbeck Process</a></li>
<li><a href="#simulation">Simulation</a></li>
<li><a href="#empirical-vs-theoretical-psd-trajectories">Empirical vs Theoretical PSD Trajectories</a></li>
</ul></li>
<li><a href="#write-the-ou-model-in-c">Write the OU Model in C++</a>
<ul>
<li><a href="#create-the-ou-model-object-in-c">Create the OU model object in C++</a></li>
<li><a href="#compile-the-ou-model">Compile the OU model</a></li>
<li><a href="#testing">Testing</a></li>
</ul></li>
<li><a href="#parameter-estimation">Parameter Estimation</a>
<ul>
<li><a href="#mle">MLE</a></li>
<li><a href="#lp">LP</a></li>
<li><a href="#nls">NLS</a></li>
<li><a href="#table-of-parameter-estimates">Table of Parameter Estimates</a></li>
</ul></li>
</ul>
</div>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<p>In this tutorial, you will learn how to quickly implement a simple Ornstein-Uhlenbeck (OU) process and fit its power spectral density (PSD) in R by using <strong>realPSD</strong> package. A basic understanding of C++ and object-oriented programming is required. But donâ€™t be afraid, you will be able to build your own model as long as you follow the instructions given in this vignette. For those who want to get themselves familiar with some C++ concepts, there are many great free tutorials online, for example <a href="https://www.geeksforgeeks.org/c-plus-plus/">this one</a>. For advanced users, if you are insterested in the design and theory behind <strong>realPSD</strong>, please check out the <a href="http://htmlpreview.github.io/?https://github.com/mlysy/realPSD/blob/devel-ferris-prerelease/doc/realPSD-advancedtut.html">advanced tutorial</a>.</p>
<div id="model-setup" class="section level1">
<h1>Model Setup</h1>
<div id="ornstein-uhlenbeck-process" class="section level2">
<h2>Ornstein-Uhlenbeck Process</h2>
<p>A simple OU model without the additional drift term is given by the stochastic differential equation (SDE) <span class="math display">\[
\mathrm{d}X_t = -\alpha X_t \mathrm{d}t + \beta \mathrm{d}B_t
\]</span> where <span class="math inline">\(\alpha &gt; 0\)</span> and <span class="math inline">\(\beta &gt; 0\)</span> and <span class="math inline">\(B_t\)</span> denotes Brownian motion (or Wiener process). If we assume <span class="math inline">\(X_0 \sim {\mathcal N}(0, \beta^2/\alpha)\)</span>, then <span class="math inline">\(X_t\)</span> is a stationary, zero-mean Gaussian process with autocovariance function <span class="math display">\[
\gamma(t) = \frac{\beta^2}{(2\alpha)} \cdot e^{-\alpha |t|}
\]</span> The power spectral density (PSD) is <span class="math display">\[
\operatorname{\mathcal S}_X(f) = {\mathcal F}\{\gamma(t)\} = \frac{\beta^2}{\alpha^2 + (2\pi f)^2}.
\]</span> where <span class="math inline">\(f\)</span> is the frequency in Hertz (Hz) and <span class="math inline">\(i \equiv \sqrt{-1}\)</span>.</p>
<p>In R, we can define a function to calculate the theoretical PSD.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; PSD for the OU model.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param freq Vector of frequencies</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param alpha Mean reversion parameter.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta Scale parameter.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return PSD vector at the frequencies in `freq`.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>ou_psd <span class="ot">&lt;-</span> <span class="cf">function</span>(freq, alpha, beta) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  beta<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>freq)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> alpha<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>In <strong>realPSD</strong> we provide a handy function <code>ou_sim</code> to generate the exact OU process. Note the simulation is exact since we are not using Euler approximation. This is only the case for the OU process. To simulate more general and complicated SDEs, approximation is inevitable. For that purpose, the R package <a href="https://CRAN.R-project.org/package=msde"><strong>msde</strong></a> is the state-of-the-art tool you would like to use.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># true parameter values</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>theta0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">alpha =</span> <span class="fl">3.1</span>, <span class="at">beta =</span> <span class="fl">2.2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># timescale for simulation</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>frange <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e-4</span>, <span class="fl">1e2</span>) <span class="co"># frequency range</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> frange[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">2</span> <span class="co"># sampling frequency</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>fs <span class="co"># interobservation time</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">floor</span>(fs<span class="sc">/</span>frange[<span class="dv">1</span>]) <span class="co"># number of observations</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># time domain simulation</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> <span class="fu">ou_sim</span>(<span class="at">gamma =</span> theta0[<span class="dv">1</span>], <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> theta0[<span class="dv">2</span>], <span class="at">dt =</span> dt, <span class="at">n_obs =</span> N)</span></code></pre></div>
</div>
<div id="empirical-vs-theoretical-psd-trajectories" class="section level2">
<h2>Empirical vs Theoretical PSD Trajectories</h2>
<p>We can easily see that the simulation was successful in that the empirical PSD overlaps with the theoretical PSD curve.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>psd_emp <span class="ot">&lt;-</span> <span class="fu">periodogram</span>(Xt, <span class="at">fs =</span> fs)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>psd_emp <span class="ot">&lt;-</span> psd_emp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(freq <span class="sc">&lt;</span> <span class="dv">20</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># for estimation and plotting</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>psd_bin <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(psd_emp, binning,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">bin_size =</span> bin_size, <span class="at">bin_type =</span> <span class="st">&quot;mean&quot;</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(psd_bin<span class="sc">$</span>freq, psd_bin<span class="sc">$</span>Ypsd, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Frequency (Hz)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PSD&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ou_psd</span>(<span class="at">freq =</span> x, <span class="at">alpha =</span> theta0[<span class="dv">1</span>], <span class="at">beta =</span> theta0[<span class="dv">2</span>]),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="write-the-ou-model-in-c" class="section level1">
<h1>Write the OU Model in C++</h1>
<div id="create-the-ou-model-object-in-c" class="section level2">
<h2>Create the OU model object in C++</h2>
<p>To provide efficient estimation for general parametric PSD models, <strong>realPSD</strong> requires you to write your own model in a standalone C++ header file (with extension <code>.h</code> or <code>.hpp</code>). Here we have it ready for you.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">/// </span><span class="an">@file</span><span class="co"> OU_Model.hpp</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;realPSD/utils.hpp&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> ou {</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> realPSD; <span class="co">// import functions from utils.hpp</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// The Ornstein-Uhlenbeck model class.</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">///</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// The PSD of the Ornstein-Uhlenbeck (OU) model is defined as</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">///</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">\f[</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// U(f </span><span class="an">\mid</span><span class="co"> </span><span class="an">\alpha)</span><span class="co"> = </span><span class="an">\frac{1}{(2\pi</span><span class="co"> f)^2 + </span><span class="an">\alpha^2}.</span><span class="co"> </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="er">\f]</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// The parameter is supplied as </span><span class="an">\f$</span><span class="co">\phi = \log \alpha</span><span class="an">\f$</span><span class="co">.</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span> &lt;<span class="kw">class</span> Type&gt;</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> UFun {</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span>:</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// internal variables</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N_; <span class="co">///&gt; problem dimensions</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    matrix&lt;Type&gt; <span class="va">f_</span>; <span class="co">///&gt;column vector of frequencies.</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    matrix&lt;Type&gt; <span class="va">f2_</span>; <span class="co">///&gt; column vector of squared frequencies.</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    Type <span class="va">scale_</span>; <span class="co">///&gt; Scaling factor for frequencies.</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span>:</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// Constructor.</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    UFun(<span class="dt">int</span> N);</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// Set frequency vector.</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> set_f(cRefMatrix&lt;Type&gt;&amp; f);</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// Evaluate the normalized PSD.</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> eval(RefMatrix&lt;Type&gt; U, cRefMatrix&lt;Type&gt;&amp; phi);</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">@param[in]</span><span class="co"> </span><span class="cv">N</span><span class="co"> Number of frequency/PSD observations.</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span>&lt;<span class="kw">class</span> Type&gt;</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="kw">inline</span> UFun&lt;Type&gt;::UFun(<span class="dt">int</span> N) {</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    N_ = N;</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="va">f_</span> = zero_matrix&lt;Type&gt;(N_, <span class="dv">1</span>);</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="va">f2_</span> = zero_matrix&lt;Type&gt;(N_,<span class="dv">1</span>);</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="va">scale_</span> = Type(<span class="fl">4.0</span> * EIGEN_PI * EIGEN_PI);</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">@param[in]</span><span class="co"> </span><span class="cv">f</span><span class="co"> Frequency vector of size `N`.</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span>&lt;<span class="kw">class</span> Type&gt;</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="kw">inline</span> <span class="dt">void</span> UFun&lt;Type&gt;::set_f(cRefMatrix&lt;Type&gt;&amp; f) {</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    N_ = f.size();</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="va">f_</span> = zero_matrix&lt;Type&gt;(N_,<span class="dv">1</span>);</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="va">f_</span> = f;</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="va">f2_</span> = zero_matrix&lt;Type&gt;(N_,<span class="dv">1</span>);</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="va">f2_</span> = f.cwiseProduct(f);</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>;</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">@param[out]</span><span class="co"> </span><span class="cv">U</span><span class="co"> Normalized PSD vector of size `N`.</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">@param[in]</span><span class="co"> </span><span class="cv">phi</span><span class="co"> Computational basis parameters.  Here we have `phi = log(alpha)`.</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span> &lt;<span class="kw">class</span> Type&gt;</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  <span class="kw">inline</span> <span class="dt">void</span> UFun&lt;Type&gt;::eval(RefMatrix&lt;Type&gt; U, cRefMatrix&lt;Type&gt;&amp; phi) {</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    U = (<span class="va">scale_</span> * <span class="va">f2_</span>).array() + exp(Type(<span class="fl">2.0</span>)*phi(<span class="dv">0</span>,<span class="dv">0</span>));</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">// U = exp(Type(2.0)*phi(1,0)) / U.array();</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    U = U.array().inverse();</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>;</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="pp">#undef TMB_OBJECTIVE_PTR</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TMB_OBJECTIVE_PTR </span>obj</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// External constructor for `ou::UFun` objects.</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">///</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// The arguments to this function are always `N` and `obj`.  Inside the function, we can specify additional TMB macros (`DATA_VECTOR`, etc.), to obtain inputs to the `UFun` constructor.</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>  <span class="co">///</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">@param[in]</span><span class="co"> </span><span class="cv">N</span><span class="co"> Number of frequency/psd observations.</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">@param[in]</span><span class="co"> </span><span class="cv">obj</span><span class="co"> Pointer to the TMB object.</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  <span class="co">/// </span><span class="an">@return</span><span class="co"> An `ou::UFun` object.</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span>&lt;<span class="kw">class</span> Type&gt;</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>  UFun&lt;Type&gt; make_Ufun(<span class="dt">int</span> N, objective_function&lt;Type&gt;* obj) {</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> UFun&lt;Type&gt;(N);</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="pp">#undef TMB_OBJECTIVE_PTR</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TMB_OBJECTIVE_PTR </span><span class="kw">this</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>} <span class="co">// end namespace ou</span></span></code></pre></div>
<p>Basically, we defined a <code>UFun</code> class within our own namespace <code>ou</code> to avoid any potential scope conflict with the <strong>realPSD</strong> package. Later whenever we refer to this class, we will use <code>ou::UFun</code> to emphasize its namespace. The <code>ou::UFun</code> class is nothing fancy but just a collection of necessary data and functions we need to evaluate the likelihood function of the OU process. In our specific example, we need to provide the length of the simulated time series <code>N</code> (which is supplied via the constructor function <code>UFun(int N)</code>), a vector of frequencies <code>f</code> (which is supplied via function <code>set_f</code>) and a function <code>eval</code> to evaluate the PSD. If you look at the definition of <code>eval</code> function</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode c++"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">/// </span><span class="an">@param[out]</span><span class="co"> </span><span class="cv">U</span><span class="co"> Normalized PSD vector of size `N`.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">/// </span><span class="an">@param[in]</span><span class="co"> </span><span class="cv">phi</span><span class="co"> Computational basis parameters.  Here we have `phi = log(alpha)`.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> &lt;<span class="kw">class</span> Type&gt;</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> UFun&lt;Type&gt;::eval(RefMatrix&lt;Type&gt; U, cRefMatrix&lt;Type&gt;&amp; phi) {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  U = (<span class="va">scale_</span> * <span class="va">f2_</span>).array() + exp(Type(<span class="fl">2.0</span>)*phi(<span class="dv">0</span>,<span class="dv">0</span>));</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// U = exp(Type(2.0)*phi(1,0)) / U.array();</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  U = U.array().inverse();</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>;</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>you will notice it is basically the C++ translation of the R function <code>ou_psd</code>. The only difference is that for numerical purposes, we define the PSD as <span class="math inline">\(S(f) = \beta^2 U(f)\)</span> where <span class="math display">\[
U(f) = \frac{1}{(2\pi f)^2 + \alpha^2}
\]</span> is the normalized PSD we are using in <strong>realPSD</strong>.</p>
<p>The private member variables <code>f_</code>, <code>f2_</code> and <code>scale_</code> can be understood as some intermediary variables to help us create the function <code>eval</code> eventually. But we donâ€™t need them to be visible outside of the class <code>ou::UFun</code>, so they are private. These variables are by no means mandatory but just for convenience. You should think about how to create your own private members based on your specific model.</p>
<p>As for <code>RefMatrix&lt;Type&gt;</code>, it is a user-defined data type used by <strong>realPSD</strong> to help users make use of data types in C++ <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen</a> library. You can understand <code>RefMatrix&lt;Type&gt;</code> simply as a built-in data type for matrix. Please make sure you have the line <code>#include &quot;realPSD/utils.hpp&quot;</code> at the beginning of your header file. Then you header file will automatically include some tools to facilitate your job.</p>
<p>You may also notice that we have an external constructor <code>template&lt;class Type&gt; UFun&lt;Type&gt; make_Ufun(...)</code> for <code>ou::UFun</code> class. Just copy and paste this function to the end of your header file (still within the namespace), it will help you get around some technical issues involved in <a href="https://github.com/mlysy/TMB"><strong>TMB</strong></a>. For more details, please see the <a href="http://htmlpreview.github.io/?https://github.com/mlysy/realPSD/blob/devel-ferris-prerelease/doc/realPSD-advancedtut.html">advanced tutorial</a>.</p>
<p>To summarize, you can follow the steps below to create a model header file:</p>
<ol style="list-style-type: decimal">
<li>Create an empty C++ header file with extension <code>.h</code> or <code>.hpp</code> and name it whatever you like. In our example, we name the file <code>OU_Model.hpp</code>. Put it under the current working directory.</li>
<li>Give a name to your namespace to wrap up your model class. Usually the namespace is named according to your model, e.g.Â <code>ou</code> in our example.</li>
<li>Create a <code>UFun</code> class within your namespace. It is recommended to define the class as a template class in the way as shown in our example, i.e.Â <code>template &lt;class Type&gt;   class UFun {...};</code>. It would enable you to make use of the data types given by C++ <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen</a> library.</li>
<li>Create necessary public members (variables or functions) to get data from outside and to evaluate your normalized PSD, i.e.Â the U(f) function and necessary private members for internal computation. Usually it is a good idea to make your own constructor (instead of using the default constructor) to initialize some private data members as we did in the example.</li>
<li>The rest of the file should be just a simple copy-and-paste of the above example header file.</li>
</ol>
</div>
<div id="compile-the-ou-model" class="section level2">
<h2>Compile the OU model</h2>
<p>Now letâ€™s compile the header file and create the <code>ou_model</code> object as follows:</p>
<p><strong>Step 1:</strong> The package <strong>realPSD</strong> uses <a href="https://github.com/mlysy/TMB"><strong>TMB</strong></a> internally for model building and estimation. But you donâ€™t need to learn how to use <a href="https://github.com/mlysy/TMB"><strong>TMB</strong></a> from scratch. <strong>realPSD</strong> provides a wrapper function <code>make_psd_model</code> to help you automatically generate a C++ file (called â€œOU_FitMethods.cppâ€) needed by <a href="https://github.com/mlysy/TMB"><strong>TMB</strong></a> to compile the model.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create c++ file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ou_cpp <span class="ot">&lt;-</span> <span class="fu">make_psd_model</span>(<span class="at">model =</span> <span class="st">&quot;OU&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">header =</span> <span class="st">&quot;OU_Model.hpp&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">class =</span> <span class="st">&quot;ou::UFun&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ctor =</span> <span class="st">&quot;ou::make_Ufun&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">standalone =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this avoid compiling if file hasn&#39;t changed</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;OU_FitMethods.cpp&quot;</span>) <span class="sc">||</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">!</span><span class="fu">identical</span>(ou_cpp, <span class="fu">paste0</span>(<span class="fu">readLines</span>(<span class="st">&quot;OU_FitMethods.cpp&quot;</span>), <span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))) {</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(ou_cpp, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">file =</span> <span class="st">&quot;OU_FitMethods.cpp&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we explain the above input arguments of <code>make_psd_model</code> in detail:</p>
<ul>
<li><code>name</code>: Name of the model, in our case, weâ€™d like to name it â€œOUâ€.</li>
<li><code>header</code>: Name of the header file we just created, i.e.Â â€œOU_Model.hppâ€.</li>
<li><code>class</code>: Model class with name scope (if any), i.e.Â <code>ou::UFun</code> as shown above.</li>
<li><code>ctor</code>: Name of the external constructor in the model header file with name scope (if any). In our example, it is <code>ou::make_Ufun</code>.</li>
<li><code>include</code>: Additional include directive path, usually package specific, in this example, the path to <code>FitMethods.hpp</code>.</li>
<li><code>standalone</code>: If <code>TRUE</code> creates a standalone <code>cpp</code> file to pass to <code>TMB::compile()</code>. Otherwise, creates an <code>hpp</code> header file to be placed in a package created with <strong>TMBtools</strong>.</li>
</ul>
<p><strong>Step 2:</strong> After we have the necessary C++ file <code>OU_FitMethods.cpp</code>, we can compile it by using the following code. It will call <a href="https://github.com/mlysy/TMB"><strong>TMB</strong></a> to compile the model object. Just copy and paste the code for your own project. All you need to change is the name of the file.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compile it</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">&quot;OU_FitMethods&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>TMB<span class="sc">::</span><span class="fu">compile</span>(<span class="fu">paste0</span>(model, <span class="st">&quot;.cpp&quot;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">PKG_CXXFLAGS =</span> <span class="fu">paste0</span>(<span class="st">&quot;-I&quot;</span>, <span class="fu">system.file</span>(<span class="st">&quot;include&quot;</span>, <span class="at">package =</span> <span class="st">&quot;realPSD&quot;</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot; -std=c++11&quot;</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Using Makevars in /Users/feiyuzhu/.R/Makevars</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dyn.load</span>(TMB<span class="sc">::</span><span class="fu">dynlib</span>(model))</span></code></pre></div>
<p><strong>Step 3:</strong> Finally, we create the OU model R6 class in R to facilitate our later estimation process.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the ou_model class</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ou_model <span class="ot">&lt;-</span> R6<span class="sc">::</span><span class="fu">R6Class</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">classname =</span> <span class="st">&quot;ou_model&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">inherit =</span> realPSD<span class="sc">::</span>psd_model,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_phi_ =</span> <span class="dv">1</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tmb_model_ =</span> <span class="st">&quot;OU&quot;</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tmb_DLL_ =</span> <span class="st">&quot;OU_FitMethods&quot;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Here <code>classname</code> is user-defined and we call it â€œou_modelâ€. It will be an object inherit from an existing built-in R6 class object <code>psd_model</code> provided by <strong>realPSD</strong>, so we set <code>inherit = realPSD::psd_model</code>. <code>tmb_model_</code> should be the same as the <code>model</code> input in <code>make_psd_model</code> and <code>tmb_DLL_</code> should be the same as the name of the automatically generated C++ file in the above <strong>Step 1</strong>, i.e.Â â€œOU_FitMethodsâ€ in our case. For more details about R6 class, please see <a href="https://r6.r-lib.org/index.html">here</a>.</p>
<p>For further references, we list here the public members (with the function body omitted) of the base R6 class <code>realPSD::psd_model</code> which can be useful for our later model estimation.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Specify the estimator.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param est_type Type of estimator: &quot;lp&quot;, &quot;nls&quot;, or &quot;mle&quot;.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param bin_size Bin size.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param bin_type Type of bin: &quot;mean&quot; or &quot;median&quot;.</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>set_est <span class="ot">=</span> <span class="cf">function</span>(<span class="at">est_type =</span> <span class="fu">c</span>(<span class="st">&quot;lp&quot;</span>, <span class="st">&quot;nls&quot;</span>, <span class="st">&quot;mle&quot;</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bin_size =</span> <span class="dv">100</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bin_type =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>)) {...}</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Set the periodogram data.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param freq Frequency vector.</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param Ypsd Periodogram vector.</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>set_psd <span class="ot">=</span> <span class="cf">function</span>(freq, Ypsd) {...}</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Negative profile loglikelihood constructor.</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param phi0 Vector with which to initialize `phi`.  If missing, a vector of zeros.</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A [TMB::MakeADFun()] object.  Relevant methods are: `nlp$fn(phi)`, `nlp$gr(phi)`, `nlp$he(phi)`, and `nlp$simulate(phi)$zeta`, which returns the conditional optimum of `zeta` given `phi`.</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>nlp <span class="ot">=</span> <span class="cf">function</span>(phi0) {...}</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Negative loglikelihood constructor.</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param phi0 Vector with which to initialize `phi`.  If missing, a vector of zeros.</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param zeta0 Scalar with which to initialize `zeta`.  If missing, zero.</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A [TMB::MakeADFun()] object.  Relevant methods are: `nll$fn(phi)`, `nll$gr()`, and `nll$he()`.</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>nll <span class="ot">=</span> <span class="cf">function</span>(phi0, zeta0) {...}</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Residual constructor.</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param phi0 Vector with which to initialize `phi`.  If missing, a vector of zeros.</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param zeta0 Scalar with which to initialize `zeta`.  If missing, zero.</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A [TMB::MakeADFun()] object.  Relevant methods are: `resid$fn(phi)` and `resid$gr(phi)`.</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">=</span> <span class="cf">function</span>(phi0, zeta0) {...}</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Normalized PSD constructor.</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param phi0 Vector with which to initialize `phi`.  If missing, a vector of zeros.</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A [TMB::MakeADFun()] object.  Relevant methods are: `ufun$fn(phi)` and `ufun$gr(phi)`.</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>ufun <span class="ot">=</span> <span class="cf">function</span>(phi0) {...}</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Calculate the optimal value of the log normalizing constant.</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param phi0 Vector with which to initialize `phi`.  If missing, a vector of zeros.</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A [TMB::MakeADFun()] object.  Relevant methods are: `zeta$fn(phi)`, `zeta$gr()`, and `zeta$he()`.</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>zeta <span class="ot">=</span> <span class="cf">function</span>(phi0) {...}</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Calculate the variance estimator for the parameter fitting method.</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param phi Vector of normalized PSD parameters.</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param zeta Log of normalization parameter.</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param to_theta If `TRUE`, calculates the variance in the inferential basis.  Otherwise, uses the computational basis.</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A variance matrix of size `n_phi x n_phi`.</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>vcov <span class="ot">=</span> <span class="cf">function</span>(phi, zeta, <span class="at">to_theta =</span> <span class="cn">FALSE</span>) {...}</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @description Model object constructor.</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param freq Frequency vector.</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param Ypsd Periodogram vector.</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param est_type Type of estimator: &quot;lp&quot;, &quot;nls&quot;, or &quot;mle&quot;.</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param bin_size Bin size.</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param bin_type Type of bin: &quot;mean&quot; or &quot;median&quot;.</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param ctor_args Optional list of additional arguments to TMB `UFun()` constructor.</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>initialize <span class="ot">=</span> <span class="cf">function</span>(freq, Ypsd,</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est_type =</span> <span class="fu">c</span>(<span class="st">&quot;lp&quot;</span>, <span class="st">&quot;nls&quot;</span>, <span class="st">&quot;mle&quot;</span>),</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bin_size =</span> <span class="dv">100</span>,</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bin_type =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>),</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ctor_args =</span> <span class="cn">NULL</span>) {...}</span></code></pre></div>
</div>
<div id="testing" class="section level2">
<h2>Testing</h2>
<p>To check whether the implementation is correct, weâ€™ll compare the <strong>TMB</strong> implementation of the <span class="math inline">\(U(f, \phi)\)</span> method of <code>ou_model</code> to a pure R functional implementation.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construct the model object</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ou_obj <span class="ot">&lt;-</span> ou_model<span class="sc">$</span><span class="fu">new</span>(<span class="at">freq =</span> psd_emp<span class="sc">$</span>freq, <span class="at">Ypsd =</span> psd_emp<span class="sc">$</span>Ypsd,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bin_size =</span> <span class="dv">100</span>, <span class="at">est_type =</span> <span class="st">&quot;lp&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ou_ufun <span class="ot">&lt;-</span> ou_obj<span class="sc">$</span><span class="fu">ufun</span>() <span class="co"># TMB method corresponding to UFun.eval()</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>U_tmb <span class="ot">&lt;-</span> ou_ufun<span class="sc">$</span><span class="fu">fn</span>(<span class="fu">log</span>(theta0[<span class="dv">1</span>])) <span class="co"># evaluate at frequencies for lp estimator</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># same calculation in R</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>U_r <span class="ot">&lt;-</span> <span class="fu">ou_psd</span>(<span class="at">freq =</span> psd_bin<span class="sc">$</span>freq, <span class="at">alpha =</span> theta0[<span class="dv">1</span>], <span class="at">beta =</span> <span class="dv">1</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(U_tmb <span class="sc">-</span> U_r)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -1.387779e-17  1.387779e-17</span></span></code></pre></div>
<p>Note that we used <code>ou_model$new()</code> to initialize the OU model object. The input arguments can be found in the <code>initialize</code> method listed above for the R6 base class <code>realPSD::psd_model</code>.</p>
<p>It is always a good idea to do this kind of tests in the process of building your own model. The R package <a href="https://CRAN.R-project.org/package=testthat"><strong>testthat</strong></a> is great for this purpose. For more details about unit tests, please see <a href="https://testthat.r-lib.org">here</a>.</p>
</div>
</div>
<div id="parameter-estimation" class="section level1">
<h1>Parameter Estimation</h1>
<p>Now we are ready to fit the OU model by using <strong>realPSD</strong>. Three methods are provided, i.e.Â maximum likelihood estimation (MLE), log periodogram estimation (LP), non-linear least squares estimation (NLS). The theoretical background of these three methods is summarized in the <a href="http://htmlpreview.github.io/?https://github.com/mlysy/realPSD/blob/devel-ferris-prerelease/doc/realPSD-advancedtut.html">advanced tutorial</a>. More technical details can be found in this <a href>preprint</a>.</p>
<p>Before we start to fit the OU PSD, letâ€™s first define a helper function to help us convert parameters.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#` Helper function to convert a value of `phi_est` into `eta_coef` and `eta_vcov`.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#` @param phi Value of `phi`.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#` @param obj Model object created by `ou_model`.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#` @return List with elements `coef` and `vcov` of parameters on the computational basis, `eta = (phi, zeta)`.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>to_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(phi, obj) {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">phi =</span> phi, <span class="at">zeta =</span> obj<span class="sc">$</span><span class="fu">nlp</span>()<span class="sc">$</span><span class="fu">simulate</span>(phi)<span class="sc">$</span>zeta)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="at">phi =</span> fit<span class="sc">$</span>phi, <span class="at">zeta =</span> fit<span class="sc">$</span>zeta),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">vcov =</span> obj<span class="sc">$</span><span class="fu">vcov</span>(<span class="at">phi =</span> fit<span class="sc">$</span>phi, <span class="at">zeta =</span> fit<span class="sc">$</span>zeta))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(fit<span class="sc">$</span>vcov) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(fit<span class="sc">$</span>vcov) <span class="ot">&lt;-</span> <span class="fu">names</span>(fit<span class="sc">$</span>coef)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  fit</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="mle" class="section level2">
<h2>MLE</h2>
<p>We can fit the OU model using MLE (profile likelihood) as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate TMB object for profile likelihood</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ou_obj<span class="sc">$</span><span class="fu">set_est</span>(<span class="at">est_type =</span> <span class="st">&quot;mle&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ou_nlp <span class="ot">&lt;-</span> ou_obj<span class="sc">$</span><span class="fu">nlp</span>()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> ou_nlp<span class="sc">$</span>fn, <span class="at">lower =</span> <span class="fu">log</span>(.<span class="dv">1</span>), <span class="at">upper =</span> <span class="fu">log</span>(<span class="dv">10</span>))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>mle_fit <span class="ot">&lt;-</span> <span class="fu">to_fit</span>(opt<span class="sc">$</span>min, ou_obj)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(psd_bin<span class="sc">$</span>freq, psd_bin<span class="sc">$</span>Ypsd, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Frequency (Hz)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PSD&quot;</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ou_psd</span>(<span class="at">freq =</span> x, <span class="at">alpha =</span> <span class="fu">exp</span>(mle_fit<span class="sc">$</span>coef[<span class="dv">1</span>]), <span class="at">beta =</span> <span class="fu">exp</span>(mle_fit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>)),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, the fitted curve fits the simulated data very well.</p>
</div>
<div id="lp" class="section level2">
<h2>LP</h2>
<p>Similarly, we can fit the model using LP method.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate TMB object for profile likelihood</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ou_obj<span class="sc">$</span><span class="fu">set_est</span>(<span class="at">est_type =</span> <span class="st">&quot;lp&quot;</span>, <span class="at">bin_size =</span> bin_size)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ou_nlp <span class="ot">&lt;-</span> ou_obj<span class="sc">$</span><span class="fu">nlp</span>()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> ou_nlp<span class="sc">$</span>fn, <span class="at">lower =</span> <span class="fu">log</span>(.<span class="dv">1</span>), <span class="at">upper =</span> <span class="fu">log</span>(<span class="dv">10</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>lp_fit <span class="ot">&lt;-</span> <span class="fu">to_fit</span>(opt<span class="sc">$</span>min, ou_obj)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(psd_bin<span class="sc">$</span>freq, psd_bin<span class="sc">$</span>Ypsd, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Frequency (Hz)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PSD&quot;</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ou_psd</span>(<span class="at">freq =</span> x, <span class="at">alpha =</span> <span class="fu">exp</span>(lp_fit<span class="sc">$</span>coef[<span class="dv">1</span>]), <span class="at">beta =</span> <span class="fu">exp</span>(lp_fit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>)),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="nls" class="section level2">
<h2>NLS</h2>
<p>We can implement the NLS method using the following code.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate TMB object for profile likelihood</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ou_obj<span class="sc">$</span><span class="fu">set_est</span>(<span class="at">est_type =</span> <span class="st">&quot;nls&quot;</span>, <span class="at">bin_size =</span> bin_size)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ou_nlp <span class="ot">&lt;-</span> ou_obj<span class="sc">$</span><span class="fu">nlp</span>()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> ou_nlp<span class="sc">$</span>fn, <span class="at">lower =</span> <span class="fu">log</span>(.<span class="dv">1</span>), <span class="at">upper =</span> <span class="fu">log</span>(<span class="dv">10</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>nls_fit <span class="ot">&lt;-</span> <span class="fu">to_fit</span>(opt<span class="sc">$</span>min, ou_obj)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(psd_bin<span class="sc">$</span>freq, psd_bin<span class="sc">$</span>Ypsd, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Frequency (Hz)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PSD&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ou_psd</span>(<span class="at">freq =</span> x, <span class="at">alpha =</span> <span class="fu">exp</span>(lp_fit<span class="sc">$</span>coef[<span class="dv">1</span>]), <span class="at">beta =</span> <span class="fu">exp</span>(lp_fit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>)),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="table-of-parameter-estimates" class="section level2">
<h2>Table of Parameter Estimates</h2>
<p>Finally, letâ€™s summarize the estimates in the following table for comparison. As we can see, LP gives very close estimates as MLE and the estimator of both methods produced very small standard errors. NLS, on the other hand, gives an estimator with significantly larger standard errors. This result is expected since NLS for the numerical estimation speed, sacrifices the estimation efficiency. That is price we have to pay.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">list</span>(<span class="at">mle =</span> mle_fit, <span class="at">lp =</span> lp_fit, <span class="at">nls =</span> nls_fit),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>               <span class="cf">function</span>(fit) <span class="fu">c</span>(fit<span class="sc">$</span>coef[<span class="dv">1</span>], <span class="fu">sqrt</span>(fit<span class="sc">$</span>vcov[<span class="dv">1</span>,<span class="dv">1</span>]),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                               fit<span class="sc">$</span>coef[<span class="dv">2</span>], <span class="fu">sqrt</span>(fit<span class="sc">$</span>vcov[<span class="dv">2</span>,<span class="dv">2</span>])))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">true =</span> <span class="fu">c</span>(<span class="fu">log</span>(theta0[<span class="dv">1</span>]), <span class="cn">NA</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(theta0[<span class="dv">2</span>]), <span class="cn">NA</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>              disp)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> <span class="fu">t</span>(disp)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(disp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;phi_est&quot;</span>, <span class="st">&quot;phi_se&quot;</span>, <span class="st">&quot;zeta_est&quot;</span>, <span class="st">&quot;zeta_se&quot;</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(disp, <span class="dv">3</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      phi_est  phi_se zeta_est zeta_se</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; true    1.13      NA     1.58      NA</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle     1.15 0.00830     1.59 0.00233</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp      1.15 0.00835     1.59 0.00233</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nls     1.13 0.02210     1.57 0.02650</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
